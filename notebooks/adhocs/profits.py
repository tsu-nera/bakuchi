{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Profit分析"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 目的\n",
    "\n",
    "予測での利益と実際の利益の差分をみてみる。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [],
   "source": [
    "import datetime\n",
    "import numpy as np\n",
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/home/tsu-nera/repo/bakuchi\n"
     ]
    }
   ],
   "source": [
    "import sys\n",
    "sys.path.append('../../')\n",
    "%cd '../../'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "timestamp = \"2003200210\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "def read_trades(timestamp, exchange_id):\n",
    "    file_path = \"reports/{}/trades/{}.csv\".format(timestamp, exchange_id)\n",
    "    return pd.read_csv(file_path, index_col=\"id\", parse_dates=[\"datetime\"])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "cc_trades = read_trades(timestamp, \"coincheck\")\n",
    "lq_trades = read_trades(timestamp, \"liquid\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(312, 312)"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "len(cc_trades), len(lq_trades)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "def read_ticks(timestamp, exchange_id):\n",
    "    file_path = \"reports/{}/exchanges/{}.csv\".format(timestamp, exchange_id)\n",
    "    df = pd.read_csv(file_path, index_col=\"timestamp\", parse_dates=[\"timestamp\"])\n",
    "    df[\"request_tick\"] = df[\"tick_timestamp\"]\n",
    "    df[\"response_tick\"] = df.index\n",
    "    df = df.drop([\"tick_timestamp\"], axis=1)\n",
    "    return df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "cc_ticks = read_ticks(timestamp, \"coincheck\")\n",
    "lq_ticks = read_ticks(timestamp, \"liquid\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>bid</th>\n",
       "      <th>ask</th>\n",
       "      <th>request_tick</th>\n",
       "      <th>response_tick</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>timestamp</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2020-03-20 02:10:49</th>\n",
       "      <td>688935.0</td>\n",
       "      <td>689702.0</td>\n",
       "      <td>2020-03-20 02:10:49</td>\n",
       "      <td>2020-03-20 02:10:49</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 02:10:51</th>\n",
       "      <td>689474.0</td>\n",
       "      <td>689761.0</td>\n",
       "      <td>2020-03-20 02:10:51</td>\n",
       "      <td>2020-03-20 02:10:51</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 02:10:52</th>\n",
       "      <td>689474.0</td>\n",
       "      <td>689761.0</td>\n",
       "      <td>2020-03-20 02:10:52</td>\n",
       "      <td>2020-03-20 02:10:52</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 02:10:53</th>\n",
       "      <td>689474.0</td>\n",
       "      <td>689761.0</td>\n",
       "      <td>2020-03-20 02:10:53</td>\n",
       "      <td>2020-03-20 02:10:53</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 02:10:54</th>\n",
       "      <td>689474.0</td>\n",
       "      <td>689761.0</td>\n",
       "      <td>2020-03-20 02:10:54</td>\n",
       "      <td>2020-03-20 02:10:54</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                          bid       ask         request_tick  \\\n",
       "timestamp                                                      \n",
       "2020-03-20 02:10:49  688935.0  689702.0  2020-03-20 02:10:49   \n",
       "2020-03-20 02:10:51  689474.0  689761.0  2020-03-20 02:10:51   \n",
       "2020-03-20 02:10:52  689474.0  689761.0  2020-03-20 02:10:52   \n",
       "2020-03-20 02:10:53  689474.0  689761.0  2020-03-20 02:10:53   \n",
       "2020-03-20 02:10:54  689474.0  689761.0  2020-03-20 02:10:54   \n",
       "\n",
       "                          response_tick  \n",
       "timestamp                                \n",
       "2020-03-20 02:10:49 2020-03-20 02:10:49  \n",
       "2020-03-20 02:10:51 2020-03-20 02:10:51  \n",
       "2020-03-20 02:10:52 2020-03-20 02:10:52  \n",
       "2020-03-20 02:10:53 2020-03-20 02:10:53  \n",
       "2020-03-20 02:10:54 2020-03-20 02:10:54  "
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "cc_ticks.head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [],
   "source": [
    "trades = []\n",
    "\n",
    "for cc_row, lq_row in zip(cc_trades.iterrows(), lq_trades.iterrows()):\n",
    "    cc_item = cc_row[1]\n",
    "    lq_item = lq_row[1]\n",
    "    \n",
    "    cc_side = cc_item[\"side\"]\n",
    "    cc_timestamp = cc_item[\"datetime\"]\n",
    "    cc_amount = cc_item[\"amount\"]\n",
    "    cc_actual_price = cc_item[\"price\"]\n",
    "    cc_actual_rate = cc_item[\"rate\"]\n",
    "\n",
    "    lq_side = lq_item[\"side\"]\n",
    "    lq_timestamp = lq_item[\"datetime\"]\n",
    "    lq_amount = lq_item[\"amount\"]\n",
    "    lq_actual_price = lq_item[\"price\"]\n",
    "    lq_actual_rate = lq_item[\"rate\"]\n",
    "    \n",
    "    try:\n",
    "        cc_tick = cc_ticks.loc[cc_timestamp]\n",
    "    except Exception:\n",
    "        timestamp = cc_timestamp + datetime.timedelta(seconds=1)\n",
    "        cc_tick = cc_ticks.loc[timestamp]\n",
    "    try:\n",
    "        lq_tick = lq_ticks.loc[lq_timestamp]\n",
    "    except Exception:\n",
    "        timestamp = lq_timestamp + datetime.timedelta(seconds=1)\n",
    "        lq_tick = lq_ticks.loc[timestamp]        \n",
    "\n",
    "    if cc_side == \"sell\":\n",
    "        cc_tick_rate = cc_tick.bid\n",
    "    else:\n",
    "        cc_tick_rate = cc_tick.ask\n",
    "    if lq_side == \"sell\":\n",
    "        lq_tick_rate = lq_tick.bid\n",
    "    else:\n",
    "        lq_tick_rate = lq_tick.ask\n",
    "        \n",
    "    cc_expected_price = cc_tick_rate * cc_amount\n",
    "    lq_expected_price = lq_tick_rate * lq_amount\n",
    "\n",
    "    \n",
    "    if cc_side == \"buy\":\n",
    "        cc_expected_price = cc_expected_price * -1\n",
    "        cc_actual_price = cc_actual_price * -1\n",
    "    if lq_side == \"buy\":\n",
    "        lq_expected_price = lq_expected_price * -1\n",
    "        lq_actual_price = lq_actual_price * -1\n",
    "        \n",
    "    expected_profit = sum([cc_expected_price, lq_expected_price])\n",
    "    actual_profit = sum([cc_actual_price, lq_actual_price])\n",
    "\n",
    "    trade = {\n",
    "        \"timestamp\": cc_timestamp, \n",
    "        \"cc_side\": cc_side,\n",
    "        \"cc_expected_rate\": cc_tick_rate,\n",
    "        \"cc_actual_rate\": cc_actual_rate,\n",
    "        \"cc_expected_price\": cc_expected_price,\n",
    "        \"cc_actual_price\": cc_actual_price,\n",
    "        \"lq_side\": lq_side,\n",
    "        \"lq_expected_rate\": lq_tick_rate,\n",
    "        \"lq_actual_rate\": lq_actual_rate,\n",
    "        \"lq_expected_price\": lq_expected_price,\n",
    "        \"lq_actual_price\": lq_actual_price,\n",
    "        \"expected_profit\": expected_profit,\n",
    "        \"actual_profit\": actual_profit\n",
    "    }\n",
    "    \n",
    "    trades.append(trade)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [],
   "source": [
    "trade_df = pd.DataFrame(trades)\n",
    "trade_df = trade_df.set_index(\"timestamp\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [],
   "source": [
    "profit_df = trade_df[[\"expected_profit\", \"actual_profit\"]]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(2611, 646)"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "int(sum(profit_df[\"expected_profit\"])), int(sum(profit_df[\"actual_profit\"]))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>expected_profit</th>\n",
       "      <th>actual_profit</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>timestamp</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2020-03-20 02:10:49</th>\n",
       "      <td>13.104000</td>\n",
       "      <td>16.231</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 02:30:22</th>\n",
       "      <td>1.851135</td>\n",
       "      <td>-8.173</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 02:30:31</th>\n",
       "      <td>17.842500</td>\n",
       "      <td>14.285</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 02:32:43</th>\n",
       "      <td>-1.352619</td>\n",
       "      <td>-9.594</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 02:32:48</th>\n",
       "      <td>14.274000</td>\n",
       "      <td>13.904</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 02:46:25</th>\n",
       "      <td>6.438730</td>\n",
       "      <td>-4.422</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 02:46:45</th>\n",
       "      <td>15.255500</td>\n",
       "      <td>14.904</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 02:46:53</th>\n",
       "      <td>1.829274</td>\n",
       "      <td>-10.375</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 02:46:59</th>\n",
       "      <td>17.400500</td>\n",
       "      <td>10.943</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 02:47:33</th>\n",
       "      <td>-0.081456</td>\n",
       "      <td>-9.684</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 02:47:37</th>\n",
       "      <td>17.309500</td>\n",
       "      <td>12.532</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 02:49:43</th>\n",
       "      <td>9.099175</td>\n",
       "      <td>-7.425</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 02:49:47</th>\n",
       "      <td>22.997000</td>\n",
       "      <td>17.199</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 02:50:05</th>\n",
       "      <td>-8.301338</td>\n",
       "      <td>-13.294</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 02:50:10</th>\n",
       "      <td>17.758000</td>\n",
       "      <td>17.329</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 02:52:21</th>\n",
       "      <td>0.919953</td>\n",
       "      <td>-8.101</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 02:52:25</th>\n",
       "      <td>21.723000</td>\n",
       "      <td>15.866</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 02:59:06</th>\n",
       "      <td>-6.118633</td>\n",
       "      <td>-13.843</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 02:59:20</th>\n",
       "      <td>18.232500</td>\n",
       "      <td>18.233</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 03:03:11</th>\n",
       "      <td>23.633126</td>\n",
       "      <td>-4.921</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 03:03:16</th>\n",
       "      <td>19.909500</td>\n",
       "      <td>20.688</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 03:05:57</th>\n",
       "      <td>-13.075156</td>\n",
       "      <td>-25.607</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 03:06:01</th>\n",
       "      <td>26.390000</td>\n",
       "      <td>15.746</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 03:06:05</th>\n",
       "      <td>-2.263498</td>\n",
       "      <td>-14.230</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 03:06:26</th>\n",
       "      <td>22.925500</td>\n",
       "      <td>11.782</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 03:07:33</th>\n",
       "      <td>-7.057083</td>\n",
       "      <td>-13.028</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 03:08:00</th>\n",
       "      <td>25.070500</td>\n",
       "      <td>14.436</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 03:08:05</th>\n",
       "      <td>-10.015798</td>\n",
       "      <td>-15.915</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 03:08:45</th>\n",
       "      <td>22.834500</td>\n",
       "      <td>19.650</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 03:09:12</th>\n",
       "      <td>-10.724809</td>\n",
       "      <td>-15.673</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 03:09:31</th>\n",
       "      <td>23.081500</td>\n",
       "      <td>19.455</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 03:09:43</th>\n",
       "      <td>-8.110489</td>\n",
       "      <td>-11.943</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 03:09:53</th>\n",
       "      <td>24.797500</td>\n",
       "      <td>16.218</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 03:10:04</th>\n",
       "      <td>-5.460244</td>\n",
       "      <td>-12.549</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 03:10:36</th>\n",
       "      <td>21.131500</td>\n",
       "      <td>16.224</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 03:12:49</th>\n",
       "      <td>-5.932402</td>\n",
       "      <td>-11.793</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 03:13:06</th>\n",
       "      <td>19.084000</td>\n",
       "      <td>13.813</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 03:13:19</th>\n",
       "      <td>-0.086802</td>\n",
       "      <td>-10.749</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 03:13:27</th>\n",
       "      <td>18.778500</td>\n",
       "      <td>14.898</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 04:14:13</th>\n",
       "      <td>2.266470</td>\n",
       "      <td>-1.658</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 04:14:20</th>\n",
       "      <td>17.777500</td>\n",
       "      <td>15.925</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 04:19:15</th>\n",
       "      <td>15.523686</td>\n",
       "      <td>2.871</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 04:19:39</th>\n",
       "      <td>15.125500</td>\n",
       "      <td>12.836</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 04:20:33</th>\n",
       "      <td>-0.368107</td>\n",
       "      <td>-7.180</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 04:20:45</th>\n",
       "      <td>15.255500</td>\n",
       "      <td>13.078</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 04:24:47</th>\n",
       "      <td>-4.658611</td>\n",
       "      <td>-7.360</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 04:25:04</th>\n",
       "      <td>13.786500</td>\n",
       "      <td>8.091</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 04:29:15</th>\n",
       "      <td>8.623388</td>\n",
       "      <td>-2.333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 04:29:26</th>\n",
       "      <td>9.529000</td>\n",
       "      <td>4.433</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 04:33:10</th>\n",
       "      <td>2.565714</td>\n",
       "      <td>-2.226</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 04:33:21</th>\n",
       "      <td>6.955000</td>\n",
       "      <td>4.193</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 04:44:55</th>\n",
       "      <td>27.695749</td>\n",
       "      <td>6.844</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 04:44:56</th>\n",
       "      <td>27.695749</td>\n",
       "      <td>7.962</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 04:44:58</th>\n",
       "      <td>10.712000</td>\n",
       "      <td>9.055</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 04:44:59</th>\n",
       "      <td>10.712000</td>\n",
       "      <td>13.345</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 04:45:18</th>\n",
       "      <td>8.412641</td>\n",
       "      <td>-3.484</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 04:45:21</th>\n",
       "      <td>10.491000</td>\n",
       "      <td>9.283</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 04:46:14</th>\n",
       "      <td>4.080175</td>\n",
       "      <td>-1.491</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 04:46:15</th>\n",
       "      <td>9.054500</td>\n",
       "      <td>8.944</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 05:48:02</th>\n",
       "      <td>7.007183</td>\n",
       "      <td>-1.606</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 05:48:05</th>\n",
       "      <td>8.112000</td>\n",
       "      <td>11.927</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 06:07:13</th>\n",
       "      <td>7.048308</td>\n",
       "      <td>-0.350</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 06:08:15</th>\n",
       "      <td>6.539000</td>\n",
       "      <td>5.386</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 07:25:42</th>\n",
       "      <td>12.392326</td>\n",
       "      <td>2.396</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 07:26:39</th>\n",
       "      <td>7.299500</td>\n",
       "      <td>4.960</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 07:50:26</th>\n",
       "      <td>7.931598</td>\n",
       "      <td>0.945</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 07:50:32</th>\n",
       "      <td>8.658000</td>\n",
       "      <td>5.279</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 07:50:57</th>\n",
       "      <td>20.799136</td>\n",
       "      <td>7.207</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 07:50:59</th>\n",
       "      <td>12.792000</td>\n",
       "      <td>4.414</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 07:51:05</th>\n",
       "      <td>15.491375</td>\n",
       "      <td>13.372</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 07:51:14</th>\n",
       "      <td>10.393500</td>\n",
       "      <td>-0.396</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 07:51:22</th>\n",
       "      <td>8.702159</td>\n",
       "      <td>0.081</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 07:51:28</th>\n",
       "      <td>10.666500</td>\n",
       "      <td>5.115</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 07:51:49</th>\n",
       "      <td>8.193885</td>\n",
       "      <td>-1.796</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 07:51:56</th>\n",
       "      <td>7.618000</td>\n",
       "      <td>6.474</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 08:00:59</th>\n",
       "      <td>32.698624</td>\n",
       "      <td>-8.786</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 08:01:05</th>\n",
       "      <td>7.592000</td>\n",
       "      <td>4.283</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 08:06:16</th>\n",
       "      <td>20.827169</td>\n",
       "      <td>4.900</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 08:06:31</th>\n",
       "      <td>8.482500</td>\n",
       "      <td>2.984</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 08:07:13</th>\n",
       "      <td>12.657086</td>\n",
       "      <td>3.048</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 08:07:58</th>\n",
       "      <td>12.792000</td>\n",
       "      <td>0.760</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 08:08:03</th>\n",
       "      <td>-5.349561</td>\n",
       "      <td>-6.337</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 08:08:47</th>\n",
       "      <td>11.472500</td>\n",
       "      <td>4.901</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 08:10:10</th>\n",
       "      <td>3.881879</td>\n",
       "      <td>-2.663</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 08:11:16</th>\n",
       "      <td>10.406500</td>\n",
       "      <td>0.453</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 08:11:33</th>\n",
       "      <td>-1.196114</td>\n",
       "      <td>-5.368</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 08:12:08</th>\n",
       "      <td>7.364500</td>\n",
       "      <td>2.314</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 08:12:28</th>\n",
       "      <td>15.620370</td>\n",
       "      <td>0.537</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 08:12:29</th>\n",
       "      <td>15.620370</td>\n",
       "      <td>5.335</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 08:12:35</th>\n",
       "      <td>3.055000</td>\n",
       "      <td>3.874</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 08:12:40</th>\n",
       "      <td>8.203000</td>\n",
       "      <td>9.217</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 08:18:06</th>\n",
       "      <td>-3.054437</td>\n",
       "      <td>-3.608</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 08:18:33</th>\n",
       "      <td>10.491000</td>\n",
       "      <td>10.946</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 08:22:01</th>\n",
       "      <td>7.288438</td>\n",
       "      <td>1.586</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 08:22:07</th>\n",
       "      <td>11.505000</td>\n",
       "      <td>7.040</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 08:25:35</th>\n",
       "      <td>6.786108</td>\n",
       "      <td>-1.206</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 08:25:39</th>\n",
       "      <td>6.461000</td>\n",
       "      <td>7.513</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 09:00:30</th>\n",
       "      <td>11.826180</td>\n",
       "      <td>-2.790</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 09:00:31</th>\n",
       "      <td>14.306500</td>\n",
       "      <td>14.397</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 09:02:14</th>\n",
       "      <td>1.477857</td>\n",
       "      <td>-6.561</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 09:04:00</th>\n",
       "      <td>16.295500</td>\n",
       "      <td>13.334</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 09:05:13</th>\n",
       "      <td>0.216481</td>\n",
       "      <td>-7.251</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 09:05:43</th>\n",
       "      <td>16.887000</td>\n",
       "      <td>13.520</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 09:05:53</th>\n",
       "      <td>-0.609205</td>\n",
       "      <td>-7.018</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 09:05:59</th>\n",
       "      <td>17.823000</td>\n",
       "      <td>16.387</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 09:06:43</th>\n",
       "      <td>-1.675318</td>\n",
       "      <td>-9.173</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 09:06:52</th>\n",
       "      <td>15.177500</td>\n",
       "      <td>16.303</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 10:31:12</th>\n",
       "      <td>8.562000</td>\n",
       "      <td>-9.068</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 10:31:51</th>\n",
       "      <td>15.457000</td>\n",
       "      <td>11.277</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 10:32:26</th>\n",
       "      <td>-9.684676</td>\n",
       "      <td>-16.127</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 10:32:37</th>\n",
       "      <td>9.522500</td>\n",
       "      <td>10.730</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 10:37:33</th>\n",
       "      <td>8.600206</td>\n",
       "      <td>0.569</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 10:37:36</th>\n",
       "      <td>8.021000</td>\n",
       "      <td>6.559</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 11:01:12</th>\n",
       "      <td>5.628046</td>\n",
       "      <td>-2.461</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 11:01:54</th>\n",
       "      <td>8.853000</td>\n",
       "      <td>6.896</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 11:18:55</th>\n",
       "      <td>2.776493</td>\n",
       "      <td>-0.964</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 11:19:45</th>\n",
       "      <td>8.482500</td>\n",
       "      <td>1.904</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 11:22:28</th>\n",
       "      <td>3.537270</td>\n",
       "      <td>-0.858</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 11:30:48</th>\n",
       "      <td>1.846000</td>\n",
       "      <td>4.174</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 11:47:55</th>\n",
       "      <td>4.769519</td>\n",
       "      <td>0.341</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 11:48:05</th>\n",
       "      <td>6.656000</td>\n",
       "      <td>2.210</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 11:48:09</th>\n",
       "      <td>7.454487</td>\n",
       "      <td>1.740</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 11:58:13</th>\n",
       "      <td>7.156500</td>\n",
       "      <td>0.540</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 12:00:29</th>\n",
       "      <td>6.781495</td>\n",
       "      <td>-0.554</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 12:01:34</th>\n",
       "      <td>6.831500</td>\n",
       "      <td>2.272</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 12:42:24</th>\n",
       "      <td>5.525538</td>\n",
       "      <td>-0.139</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 12:42:44</th>\n",
       "      <td>4.842500</td>\n",
       "      <td>1.033</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 12:43:25</th>\n",
       "      <td>9.081023</td>\n",
       "      <td>-0.153</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 12:43:34</th>\n",
       "      <td>6.662500</td>\n",
       "      <td>2.736</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 12:49:16</th>\n",
       "      <td>6.029360</td>\n",
       "      <td>-0.394</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 12:53:58</th>\n",
       "      <td>6.643000</td>\n",
       "      <td>5.713</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 12:59:36</th>\n",
       "      <td>4.940340</td>\n",
       "      <td>0.120</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 13:00:44</th>\n",
       "      <td>6.571500</td>\n",
       "      <td>1.697</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 13:02:13</th>\n",
       "      <td>3.008956</td>\n",
       "      <td>2.301</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 13:07:34</th>\n",
       "      <td>6.519500</td>\n",
       "      <td>1.982</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 13:09:23</th>\n",
       "      <td>3.129814</td>\n",
       "      <td>-0.331</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 13:40:46</th>\n",
       "      <td>9.223500</td>\n",
       "      <td>2.769</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 13:40:57</th>\n",
       "      <td>0.164839</td>\n",
       "      <td>-1.447</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 13:41:49</th>\n",
       "      <td>8.476000</td>\n",
       "      <td>2.092</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 13:42:53</th>\n",
       "      <td>2.023633</td>\n",
       "      <td>-1.845</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 13:43:06</th>\n",
       "      <td>7.338500</td>\n",
       "      <td>2.997</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 13:44:40</th>\n",
       "      <td>5.139926</td>\n",
       "      <td>-0.013</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 13:50:42</th>\n",
       "      <td>6.727500</td>\n",
       "      <td>-0.624</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 14:20:36</th>\n",
       "      <td>9.601492</td>\n",
       "      <td>3.567</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 14:24:21</th>\n",
       "      <td>6.838000</td>\n",
       "      <td>5.304</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 16:34:48</th>\n",
       "      <td>4.423805</td>\n",
       "      <td>-0.404</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 16:59:26</th>\n",
       "      <td>12.995389</td>\n",
       "      <td>-1.861</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 16:59:30</th>\n",
       "      <td>-10.673000</td>\n",
       "      <td>-1.781</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 16:59:31</th>\n",
       "      <td>19.137973</td>\n",
       "      <td>15.466</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 16:59:36</th>\n",
       "      <td>-1.527500</td>\n",
       "      <td>-0.221</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:06:00</th>\n",
       "      <td>8.801000</td>\n",
       "      <td>3.517</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:06:13</th>\n",
       "      <td>-1.188644</td>\n",
       "      <td>-1.404</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:07:04</th>\n",
       "      <td>7.787000</td>\n",
       "      <td>1.469</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:07:54</th>\n",
       "      <td>5.787679</td>\n",
       "      <td>0.083</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:10:12</th>\n",
       "      <td>10.211500</td>\n",
       "      <td>4.284</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:10:21</th>\n",
       "      <td>1.425025</td>\n",
       "      <td>-3.770</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:11:05</th>\n",
       "      <td>7.065500</td>\n",
       "      <td>1.976</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:11:34</th>\n",
       "      <td>9.455881</td>\n",
       "      <td>-3.098</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:11:41</th>\n",
       "      <td>13.760500</td>\n",
       "      <td>7.826</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:11:58</th>\n",
       "      <td>3.427398</td>\n",
       "      <td>-6.675</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:12:07</th>\n",
       "      <td>7.969000</td>\n",
       "      <td>8.437</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:13:00</th>\n",
       "      <td>4.563248</td>\n",
       "      <td>-0.682</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:13:12</th>\n",
       "      <td>8.190000</td>\n",
       "      <td>4.160</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:13:56</th>\n",
       "      <td>4.028968</td>\n",
       "      <td>-1.239</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:14:08</th>\n",
       "      <td>7.091500</td>\n",
       "      <td>0.473</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:14:46</th>\n",
       "      <td>16.608793</td>\n",
       "      <td>4.201</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:14:48</th>\n",
       "      <td>16.786916</td>\n",
       "      <td>4.691</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:14:57</th>\n",
       "      <td>1.124500</td>\n",
       "      <td>-15.971</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:15:16</th>\n",
       "      <td>32.833786</td>\n",
       "      <td>13.374</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:15:27</th>\n",
       "      <td>-0.422500</td>\n",
       "      <td>-4.212</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:15:35</th>\n",
       "      <td>18.578622</td>\n",
       "      <td>14.105</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:15:41</th>\n",
       "      <td>0.877500</td>\n",
       "      <td>1.155</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:15:52</th>\n",
       "      <td>18.947500</td>\n",
       "      <td>6.409</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:15:58</th>\n",
       "      <td>-21.231685</td>\n",
       "      <td>-15.565</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:16:00</th>\n",
       "      <td>7.254000</td>\n",
       "      <td>6.182</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:18:13</th>\n",
       "      <td>12.073035</td>\n",
       "      <td>5.224</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:18:34</th>\n",
       "      <td>21.578569</td>\n",
       "      <td>8.023</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:18:42</th>\n",
       "      <td>4.621500</td>\n",
       "      <td>5.531</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:19:00</th>\n",
       "      <td>10.068500</td>\n",
       "      <td>5.083</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:19:35</th>\n",
       "      <td>21.750173</td>\n",
       "      <td>-0.780</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:19:54</th>\n",
       "      <td>73.981865</td>\n",
       "      <td>19.133</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:19:58</th>\n",
       "      <td>-6.019000</td>\n",
       "      <td>-6.961</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:20:10</th>\n",
       "      <td>13.832000</td>\n",
       "      <td>3.744</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:20:57</th>\n",
       "      <td>3.127849</td>\n",
       "      <td>-6.280</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:21:03</th>\n",
       "      <td>8.580000</td>\n",
       "      <td>10.874</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:22:04</th>\n",
       "      <td>-8.161234</td>\n",
       "      <td>-16.984</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:22:36</th>\n",
       "      <td>17.511000</td>\n",
       "      <td>2.393</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:22:38</th>\n",
       "      <td>-8.227660</td>\n",
       "      <td>-12.101</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:22:44</th>\n",
       "      <td>11.843000</td>\n",
       "      <td>4.505</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:22:51</th>\n",
       "      <td>1.909205</td>\n",
       "      <td>1.156</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:24:35</th>\n",
       "      <td>6.565000</td>\n",
       "      <td>-0.195</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:24:46</th>\n",
       "      <td>18.544979</td>\n",
       "      <td>-2.966</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:26:45</th>\n",
       "      <td>8.281000</td>\n",
       "      <td>0.676</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:27:06</th>\n",
       "      <td>8.572394</td>\n",
       "      <td>0.726</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:28:57</th>\n",
       "      <td>8.287500</td>\n",
       "      <td>-3.906</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:29:06</th>\n",
       "      <td>3.315738</td>\n",
       "      <td>-3.605</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:30:48</th>\n",
       "      <td>9.282000</td>\n",
       "      <td>2.661</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:31:45</th>\n",
       "      <td>2.268374</td>\n",
       "      <td>-1.149</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:33:34</th>\n",
       "      <td>7.826000</td>\n",
       "      <td>-0.816</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:35:16</th>\n",
       "      <td>16.895710</td>\n",
       "      <td>4.988</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:39:06</th>\n",
       "      <td>6.571500</td>\n",
       "      <td>2.548</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:39:15</th>\n",
       "      <td>7.532980</td>\n",
       "      <td>2.115</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:47:35</th>\n",
       "      <td>10.107500</td>\n",
       "      <td>3.265</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:47:57</th>\n",
       "      <td>0.208000</td>\n",
       "      <td>0.156</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:49:12</th>\n",
       "      <td>12.727000</td>\n",
       "      <td>10.609</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:49:29</th>\n",
       "      <td>-1.670856</td>\n",
       "      <td>-8.259</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:49:59</th>\n",
       "      <td>7.410000</td>\n",
       "      <td>2.471</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:51:14</th>\n",
       "      <td>7.188720</td>\n",
       "      <td>-3.272</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:52:08</th>\n",
       "      <td>7.312500</td>\n",
       "      <td>2.834</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:52:45</th>\n",
       "      <td>6.000520</td>\n",
       "      <td>1.837</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:53:02</th>\n",
       "      <td>9.802000</td>\n",
       "      <td>3.835</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:53:18</th>\n",
       "      <td>1.631012</td>\n",
       "      <td>-4.101</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:54:02</th>\n",
       "      <td>8.008000</td>\n",
       "      <td>2.314</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:54:09</th>\n",
       "      <td>-2.958278</td>\n",
       "      <td>-12.740</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:54:13</th>\n",
       "      <td>13.247000</td>\n",
       "      <td>-1.469</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:54:17</th>\n",
       "      <td>-6.346763</td>\n",
       "      <td>-11.293</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:54:23</th>\n",
       "      <td>6.513000</td>\n",
       "      <td>2.048</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:56:55</th>\n",
       "      <td>9.542538</td>\n",
       "      <td>1.121</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 17:57:23</th>\n",
       "      <td>6.643000</td>\n",
       "      <td>2.295</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 18:00:17</th>\n",
       "      <td>19.854643</td>\n",
       "      <td>6.743</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 18:00:31</th>\n",
       "      <td>8.294000</td>\n",
       "      <td>0.838</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 18:03:51</th>\n",
       "      <td>7.061520</td>\n",
       "      <td>-0.332</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 18:04:27</th>\n",
       "      <td>7.475000</td>\n",
       "      <td>7.508</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 18:52:36</th>\n",
       "      <td>1.905500</td>\n",
       "      <td>-3.054</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 18:53:03</th>\n",
       "      <td>29.100600</td>\n",
       "      <td>11.461</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 18:53:06</th>\n",
       "      <td>-6.500000</td>\n",
       "      <td>-2.535</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 18:53:33</th>\n",
       "      <td>6.838000</td>\n",
       "      <td>2.372</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 18:55:36</th>\n",
       "      <td>14.883795</td>\n",
       "      <td>4.530</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 18:55:54</th>\n",
       "      <td>9.867000</td>\n",
       "      <td>9.510</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 18:57:03</th>\n",
       "      <td>3.055329</td>\n",
       "      <td>-4.711</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 18:57:05</th>\n",
       "      <td>7.026500</td>\n",
       "      <td>6.702</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 18:58:27</th>\n",
       "      <td>12.565803</td>\n",
       "      <td>-1.162</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 18:58:40</th>\n",
       "      <td>10.744500</td>\n",
       "      <td>4.096</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 18:59:40</th>\n",
       "      <td>7.141764</td>\n",
       "      <td>-1.393</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 18:59:52</th>\n",
       "      <td>2.762500</td>\n",
       "      <td>1.430</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 19:02:03</th>\n",
       "      <td>9.023724</td>\n",
       "      <td>0.432</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 19:03:13</th>\n",
       "      <td>6.916000</td>\n",
       "      <td>1.164</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 19:30:30</th>\n",
       "      <td>1.514978</td>\n",
       "      <td>-6.668</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 19:31:02</th>\n",
       "      <td>30.509000</td>\n",
       "      <td>16.359</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 19:31:05</th>\n",
       "      <td>-22.288500</td>\n",
       "      <td>-17.400</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 19:32:06</th>\n",
       "      <td>15.925000</td>\n",
       "      <td>6.734</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 19:32:09</th>\n",
       "      <td>7.813940</td>\n",
       "      <td>0.982</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 19:32:15</th>\n",
       "      <td>36.016120</td>\n",
       "      <td>16.670</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 19:32:17</th>\n",
       "      <td>-3.055000</td>\n",
       "      <td>7.768</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 19:32:26</th>\n",
       "      <td>9.009000</td>\n",
       "      <td>5.597</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 19:33:36</th>\n",
       "      <td>19.555931</td>\n",
       "      <td>6.903</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 19:33:44</th>\n",
       "      <td>6.831500</td>\n",
       "      <td>9.269</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 19:37:04</th>\n",
       "      <td>8.218524</td>\n",
       "      <td>-2.845</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 19:37:06</th>\n",
       "      <td>8.580000</td>\n",
       "      <td>6.611</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 19:37:14</th>\n",
       "      <td>0.576660</td>\n",
       "      <td>-6.050</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 19:40:02</th>\n",
       "      <td>12.701000</td>\n",
       "      <td>5.418</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 19:44:24</th>\n",
       "      <td>1.730473</td>\n",
       "      <td>-6.052</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 19:44:36</th>\n",
       "      <td>8.307000</td>\n",
       "      <td>9.711</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 20:14:50</th>\n",
       "      <td>-4.129470</td>\n",
       "      <td>-17.083</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 20:14:57</th>\n",
       "      <td>12.850500</td>\n",
       "      <td>8.379</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 20:15:13</th>\n",
       "      <td>9.168148</td>\n",
       "      <td>-5.961</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 20:15:53</th>\n",
       "      <td>13.006500</td>\n",
       "      <td>10.374</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 20:17:00</th>\n",
       "      <td>6.124460</td>\n",
       "      <td>-5.597</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 20:17:12</th>\n",
       "      <td>12.616500</td>\n",
       "      <td>10.471</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 20:19:11</th>\n",
       "      <td>2.102007</td>\n",
       "      <td>0.067</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 20:20:48</th>\n",
       "      <td>8.677500</td>\n",
       "      <td>8.307</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 20:32:18</th>\n",
       "      <td>5.458247</td>\n",
       "      <td>-1.308</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 20:33:15</th>\n",
       "      <td>11.004500</td>\n",
       "      <td>6.831</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 20:33:34</th>\n",
       "      <td>2.611830</td>\n",
       "      <td>-3.457</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 20:34:33</th>\n",
       "      <td>10.523500</td>\n",
       "      <td>6.891</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 20:35:12</th>\n",
       "      <td>7.818714</td>\n",
       "      <td>0.058</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 20:37:00</th>\n",
       "      <td>10.432500</td>\n",
       "      <td>4.017</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 20:49:04</th>\n",
       "      <td>14.436904</td>\n",
       "      <td>-0.246</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 20:49:06</th>\n",
       "      <td>7.956000</td>\n",
       "      <td>3.888</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 21:07:20</th>\n",
       "      <td>7.219656</td>\n",
       "      <td>-0.067</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 21:07:28</th>\n",
       "      <td>7.202000</td>\n",
       "      <td>4.557</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 21:25:55</th>\n",
       "      <td>15.567241</td>\n",
       "      <td>3.521</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 21:26:17</th>\n",
       "      <td>10.237500</td>\n",
       "      <td>2.828</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 21:26:25</th>\n",
       "      <td>6.950260</td>\n",
       "      <td>-0.543</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 21:26:33</th>\n",
       "      <td>8.840000</td>\n",
       "      <td>3.562</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 21:28:53</th>\n",
       "      <td>6.200344</td>\n",
       "      <td>-3.757</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 21:29:18</th>\n",
       "      <td>8.430500</td>\n",
       "      <td>7.202</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 21:34:13</th>\n",
       "      <td>1.744593</td>\n",
       "      <td>-2.764</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 21:34:59</th>\n",
       "      <td>7.624500</td>\n",
       "      <td>0.448</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 21:40:27</th>\n",
       "      <td>11.625957</td>\n",
       "      <td>-1.679</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 21:40:34</th>\n",
       "      <td>8.521500</td>\n",
       "      <td>5.116</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 22:06:24</th>\n",
       "      <td>7.068373</td>\n",
       "      <td>-2.589</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 22:06:28</th>\n",
       "      <td>8.866000</td>\n",
       "      <td>5.397</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 22:28:45</th>\n",
       "      <td>-2.037714</td>\n",
       "      <td>2.974</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 22:28:46</th>\n",
       "      <td>10.133500</td>\n",
       "      <td>6.298</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 22:38:31</th>\n",
       "      <td>10.640479</td>\n",
       "      <td>-0.980</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 22:38:37</th>\n",
       "      <td>6.656000</td>\n",
       "      <td>8.534</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 22:48:41</th>\n",
       "      <td>-9.027979</td>\n",
       "      <td>-8.762</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 22:54:38</th>\n",
       "      <td>8.703500</td>\n",
       "      <td>7.013</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 22:58:51</th>\n",
       "      <td>3.609511</td>\n",
       "      <td>-2.352</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 22:59:08</th>\n",
       "      <td>7.052500</td>\n",
       "      <td>3.542</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 23:03:52</th>\n",
       "      <td>12.116932</td>\n",
       "      <td>5.689</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 23:03:57</th>\n",
       "      <td>6.636500</td>\n",
       "      <td>5.753</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 23:10:19</th>\n",
       "      <td>7.172701</td>\n",
       "      <td>4.319</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 23:10:31</th>\n",
       "      <td>7.033000</td>\n",
       "      <td>3.602</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 23:26:23</th>\n",
       "      <td>9.955791</td>\n",
       "      <td>-2.522</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 23:26:42</th>\n",
       "      <td>6.662500</td>\n",
       "      <td>2.255</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 23:28:12</th>\n",
       "      <td>8.965120</td>\n",
       "      <td>2.097</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 23:28:42</th>\n",
       "      <td>7.819500</td>\n",
       "      <td>2.568</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 23:33:15</th>\n",
       "      <td>10.901243</td>\n",
       "      <td>1.464</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 23:34:09</th>\n",
       "      <td>6.786000</td>\n",
       "      <td>3.725</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 23:39:10</th>\n",
       "      <td>11.512235</td>\n",
       "      <td>1.147</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 23:39:23</th>\n",
       "      <td>7.065500</td>\n",
       "      <td>0.676</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 23:39:28</th>\n",
       "      <td>10.256660</td>\n",
       "      <td>1.664</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 23:39:45</th>\n",
       "      <td>8.755500</td>\n",
       "      <td>3.036</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 23:40:17</th>\n",
       "      <td>8.184900</td>\n",
       "      <td>-1.085</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 23:41:46</th>\n",
       "      <td>7.436000</td>\n",
       "      <td>1.755</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 23:45:05</th>\n",
       "      <td>0.021309</td>\n",
       "      <td>2.088</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 23:45:49</th>\n",
       "      <td>6.929000</td>\n",
       "      <td>4.039</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 23:53:56</th>\n",
       "      <td>14.825200</td>\n",
       "      <td>2.862</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20 23:54:04</th>\n",
       "      <td>7.540000</td>\n",
       "      <td>6.715</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-21 00:10:19</th>\n",
       "      <td>9.816099</td>\n",
       "      <td>1.673</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                     expected_profit  actual_profit\n",
       "timestamp                                          \n",
       "2020-03-20 02:10:49        13.104000         16.231\n",
       "2020-03-20 02:30:22         1.851135         -8.173\n",
       "2020-03-20 02:30:31        17.842500         14.285\n",
       "2020-03-20 02:32:43        -1.352619         -9.594\n",
       "2020-03-20 02:32:48        14.274000         13.904\n",
       "2020-03-20 02:46:25         6.438730         -4.422\n",
       "2020-03-20 02:46:45        15.255500         14.904\n",
       "2020-03-20 02:46:53         1.829274        -10.375\n",
       "2020-03-20 02:46:59        17.400500         10.943\n",
       "2020-03-20 02:47:33        -0.081456         -9.684\n",
       "2020-03-20 02:47:37        17.309500         12.532\n",
       "2020-03-20 02:49:43         9.099175         -7.425\n",
       "2020-03-20 02:49:47        22.997000         17.199\n",
       "2020-03-20 02:50:05        -8.301338        -13.294\n",
       "2020-03-20 02:50:10        17.758000         17.329\n",
       "2020-03-20 02:52:21         0.919953         -8.101\n",
       "2020-03-20 02:52:25        21.723000         15.866\n",
       "2020-03-20 02:59:06        -6.118633        -13.843\n",
       "2020-03-20 02:59:20        18.232500         18.233\n",
       "2020-03-20 03:03:11        23.633126         -4.921\n",
       "2020-03-20 03:03:16        19.909500         20.688\n",
       "2020-03-20 03:05:57       -13.075156        -25.607\n",
       "2020-03-20 03:06:01        26.390000         15.746\n",
       "2020-03-20 03:06:05        -2.263498        -14.230\n",
       "2020-03-20 03:06:26        22.925500         11.782\n",
       "2020-03-20 03:07:33        -7.057083        -13.028\n",
       "2020-03-20 03:08:00        25.070500         14.436\n",
       "2020-03-20 03:08:05       -10.015798        -15.915\n",
       "2020-03-20 03:08:45        22.834500         19.650\n",
       "2020-03-20 03:09:12       -10.724809        -15.673\n",
       "2020-03-20 03:09:31        23.081500         19.455\n",
       "2020-03-20 03:09:43        -8.110489        -11.943\n",
       "2020-03-20 03:09:53        24.797500         16.218\n",
       "2020-03-20 03:10:04        -5.460244        -12.549\n",
       "2020-03-20 03:10:36        21.131500         16.224\n",
       "2020-03-20 03:12:49        -5.932402        -11.793\n",
       "2020-03-20 03:13:06        19.084000         13.813\n",
       "2020-03-20 03:13:19        -0.086802        -10.749\n",
       "2020-03-20 03:13:27        18.778500         14.898\n",
       "2020-03-20 04:14:13         2.266470         -1.658\n",
       "2020-03-20 04:14:20        17.777500         15.925\n",
       "2020-03-20 04:19:15        15.523686          2.871\n",
       "2020-03-20 04:19:39        15.125500         12.836\n",
       "2020-03-20 04:20:33        -0.368107         -7.180\n",
       "2020-03-20 04:20:45        15.255500         13.078\n",
       "2020-03-20 04:24:47        -4.658611         -7.360\n",
       "2020-03-20 04:25:04        13.786500          8.091\n",
       "2020-03-20 04:29:15         8.623388         -2.333\n",
       "2020-03-20 04:29:26         9.529000          4.433\n",
       "2020-03-20 04:33:10         2.565714         -2.226\n",
       "2020-03-20 04:33:21         6.955000          4.193\n",
       "2020-03-20 04:44:55        27.695749          6.844\n",
       "2020-03-20 04:44:56        27.695749          7.962\n",
       "2020-03-20 04:44:58        10.712000          9.055\n",
       "2020-03-20 04:44:59        10.712000         13.345\n",
       "2020-03-20 04:45:18         8.412641         -3.484\n",
       "2020-03-20 04:45:21        10.491000          9.283\n",
       "2020-03-20 04:46:14         4.080175         -1.491\n",
       "2020-03-20 04:46:15         9.054500          8.944\n",
       "2020-03-20 05:48:02         7.007183         -1.606\n",
       "2020-03-20 05:48:05         8.112000         11.927\n",
       "2020-03-20 06:07:13         7.048308         -0.350\n",
       "2020-03-20 06:08:15         6.539000          5.386\n",
       "2020-03-20 07:25:42        12.392326          2.396\n",
       "2020-03-20 07:26:39         7.299500          4.960\n",
       "2020-03-20 07:50:26         7.931598          0.945\n",
       "2020-03-20 07:50:32         8.658000          5.279\n",
       "2020-03-20 07:50:57        20.799136          7.207\n",
       "2020-03-20 07:50:59        12.792000          4.414\n",
       "2020-03-20 07:51:05        15.491375         13.372\n",
       "2020-03-20 07:51:14        10.393500         -0.396\n",
       "2020-03-20 07:51:22         8.702159          0.081\n",
       "2020-03-20 07:51:28        10.666500          5.115\n",
       "2020-03-20 07:51:49         8.193885         -1.796\n",
       "2020-03-20 07:51:56         7.618000          6.474\n",
       "2020-03-20 08:00:59        32.698624         -8.786\n",
       "2020-03-20 08:01:05         7.592000          4.283\n",
       "2020-03-20 08:06:16        20.827169          4.900\n",
       "2020-03-20 08:06:31         8.482500          2.984\n",
       "2020-03-20 08:07:13        12.657086          3.048\n",
       "2020-03-20 08:07:58        12.792000          0.760\n",
       "2020-03-20 08:08:03        -5.349561         -6.337\n",
       "2020-03-20 08:08:47        11.472500          4.901\n",
       "2020-03-20 08:10:10         3.881879         -2.663\n",
       "2020-03-20 08:11:16        10.406500          0.453\n",
       "2020-03-20 08:11:33        -1.196114         -5.368\n",
       "2020-03-20 08:12:08         7.364500          2.314\n",
       "2020-03-20 08:12:28        15.620370          0.537\n",
       "2020-03-20 08:12:29        15.620370          5.335\n",
       "2020-03-20 08:12:35         3.055000          3.874\n",
       "2020-03-20 08:12:40         8.203000          9.217\n",
       "2020-03-20 08:18:06        -3.054437         -3.608\n",
       "2020-03-20 08:18:33        10.491000         10.946\n",
       "2020-03-20 08:22:01         7.288438          1.586\n",
       "2020-03-20 08:22:07        11.505000          7.040\n",
       "2020-03-20 08:25:35         6.786108         -1.206\n",
       "2020-03-20 08:25:39         6.461000          7.513\n",
       "2020-03-20 09:00:30        11.826180         -2.790\n",
       "2020-03-20 09:00:31        14.306500         14.397\n",
       "2020-03-20 09:02:14         1.477857         -6.561\n",
       "2020-03-20 09:04:00        16.295500         13.334\n",
       "2020-03-20 09:05:13         0.216481         -7.251\n",
       "2020-03-20 09:05:43        16.887000         13.520\n",
       "2020-03-20 09:05:53        -0.609205         -7.018\n",
       "2020-03-20 09:05:59        17.823000         16.387\n",
       "2020-03-20 09:06:43        -1.675318         -9.173\n",
       "2020-03-20 09:06:52        15.177500         16.303\n",
       "2020-03-20 10:31:12         8.562000         -9.068\n",
       "2020-03-20 10:31:51        15.457000         11.277\n",
       "2020-03-20 10:32:26        -9.684676        -16.127\n",
       "2020-03-20 10:32:37         9.522500         10.730\n",
       "2020-03-20 10:37:33         8.600206          0.569\n",
       "2020-03-20 10:37:36         8.021000          6.559\n",
       "2020-03-20 11:01:12         5.628046         -2.461\n",
       "2020-03-20 11:01:54         8.853000          6.896\n",
       "2020-03-20 11:18:55         2.776493         -0.964\n",
       "2020-03-20 11:19:45         8.482500          1.904\n",
       "2020-03-20 11:22:28         3.537270         -0.858\n",
       "2020-03-20 11:30:48         1.846000          4.174\n",
       "2020-03-20 11:47:55         4.769519          0.341\n",
       "2020-03-20 11:48:05         6.656000          2.210\n",
       "2020-03-20 11:48:09         7.454487          1.740\n",
       "2020-03-20 11:58:13         7.156500          0.540\n",
       "2020-03-20 12:00:29         6.781495         -0.554\n",
       "2020-03-20 12:01:34         6.831500          2.272\n",
       "2020-03-20 12:42:24         5.525538         -0.139\n",
       "2020-03-20 12:42:44         4.842500          1.033\n",
       "2020-03-20 12:43:25         9.081023         -0.153\n",
       "2020-03-20 12:43:34         6.662500          2.736\n",
       "2020-03-20 12:49:16         6.029360         -0.394\n",
       "2020-03-20 12:53:58         6.643000          5.713\n",
       "2020-03-20 12:59:36         4.940340          0.120\n",
       "2020-03-20 13:00:44         6.571500          1.697\n",
       "2020-03-20 13:02:13         3.008956          2.301\n",
       "2020-03-20 13:07:34         6.519500          1.982\n",
       "2020-03-20 13:09:23         3.129814         -0.331\n",
       "2020-03-20 13:40:46         9.223500          2.769\n",
       "2020-03-20 13:40:57         0.164839         -1.447\n",
       "2020-03-20 13:41:49         8.476000          2.092\n",
       "2020-03-20 13:42:53         2.023633         -1.845\n",
       "2020-03-20 13:43:06         7.338500          2.997\n",
       "2020-03-20 13:44:40         5.139926         -0.013\n",
       "2020-03-20 13:50:42         6.727500         -0.624\n",
       "2020-03-20 14:20:36         9.601492          3.567\n",
       "2020-03-20 14:24:21         6.838000          5.304\n",
       "2020-03-20 16:34:48         4.423805         -0.404\n",
       "2020-03-20 16:59:26        12.995389         -1.861\n",
       "2020-03-20 16:59:30       -10.673000         -1.781\n",
       "2020-03-20 16:59:31        19.137973         15.466\n",
       "2020-03-20 16:59:36        -1.527500         -0.221\n",
       "2020-03-20 17:06:00         8.801000          3.517\n",
       "2020-03-20 17:06:13        -1.188644         -1.404\n",
       "2020-03-20 17:07:04         7.787000          1.469\n",
       "2020-03-20 17:07:54         5.787679          0.083\n",
       "2020-03-20 17:10:12        10.211500          4.284\n",
       "2020-03-20 17:10:21         1.425025         -3.770\n",
       "2020-03-20 17:11:05         7.065500          1.976\n",
       "2020-03-20 17:11:34         9.455881         -3.098\n",
       "2020-03-20 17:11:41        13.760500          7.826\n",
       "2020-03-20 17:11:58         3.427398         -6.675\n",
       "2020-03-20 17:12:07         7.969000          8.437\n",
       "2020-03-20 17:13:00         4.563248         -0.682\n",
       "2020-03-20 17:13:12         8.190000          4.160\n",
       "2020-03-20 17:13:56         4.028968         -1.239\n",
       "2020-03-20 17:14:08         7.091500          0.473\n",
       "2020-03-20 17:14:46        16.608793          4.201\n",
       "2020-03-20 17:14:48        16.786916          4.691\n",
       "2020-03-20 17:14:57         1.124500        -15.971\n",
       "2020-03-20 17:15:16        32.833786         13.374\n",
       "2020-03-20 17:15:27        -0.422500         -4.212\n",
       "2020-03-20 17:15:35        18.578622         14.105\n",
       "2020-03-20 17:15:41         0.877500          1.155\n",
       "2020-03-20 17:15:52        18.947500          6.409\n",
       "2020-03-20 17:15:58       -21.231685        -15.565\n",
       "2020-03-20 17:16:00         7.254000          6.182\n",
       "2020-03-20 17:18:13        12.073035          5.224\n",
       "2020-03-20 17:18:34        21.578569          8.023\n",
       "2020-03-20 17:18:42         4.621500          5.531\n",
       "2020-03-20 17:19:00        10.068500          5.083\n",
       "2020-03-20 17:19:35        21.750173         -0.780\n",
       "2020-03-20 17:19:54        73.981865         19.133\n",
       "2020-03-20 17:19:58        -6.019000         -6.961\n",
       "2020-03-20 17:20:10        13.832000          3.744\n",
       "2020-03-20 17:20:57         3.127849         -6.280\n",
       "2020-03-20 17:21:03         8.580000         10.874\n",
       "2020-03-20 17:22:04        -8.161234        -16.984\n",
       "2020-03-20 17:22:36        17.511000          2.393\n",
       "2020-03-20 17:22:38        -8.227660        -12.101\n",
       "2020-03-20 17:22:44        11.843000          4.505\n",
       "2020-03-20 17:22:51         1.909205          1.156\n",
       "2020-03-20 17:24:35         6.565000         -0.195\n",
       "2020-03-20 17:24:46        18.544979         -2.966\n",
       "2020-03-20 17:26:45         8.281000          0.676\n",
       "2020-03-20 17:27:06         8.572394          0.726\n",
       "2020-03-20 17:28:57         8.287500         -3.906\n",
       "2020-03-20 17:29:06         3.315738         -3.605\n",
       "2020-03-20 17:30:48         9.282000          2.661\n",
       "2020-03-20 17:31:45         2.268374         -1.149\n",
       "2020-03-20 17:33:34         7.826000         -0.816\n",
       "2020-03-20 17:35:16        16.895710          4.988\n",
       "2020-03-20 17:39:06         6.571500          2.548\n",
       "2020-03-20 17:39:15         7.532980          2.115\n",
       "2020-03-20 17:47:35        10.107500          3.265\n",
       "2020-03-20 17:47:57         0.208000          0.156\n",
       "2020-03-20 17:49:12        12.727000         10.609\n",
       "2020-03-20 17:49:29        -1.670856         -8.259\n",
       "2020-03-20 17:49:59         7.410000          2.471\n",
       "2020-03-20 17:51:14         7.188720         -3.272\n",
       "2020-03-20 17:52:08         7.312500          2.834\n",
       "2020-03-20 17:52:45         6.000520          1.837\n",
       "2020-03-20 17:53:02         9.802000          3.835\n",
       "2020-03-20 17:53:18         1.631012         -4.101\n",
       "2020-03-20 17:54:02         8.008000          2.314\n",
       "2020-03-20 17:54:09        -2.958278        -12.740\n",
       "2020-03-20 17:54:13        13.247000         -1.469\n",
       "2020-03-20 17:54:17        -6.346763        -11.293\n",
       "2020-03-20 17:54:23         6.513000          2.048\n",
       "2020-03-20 17:56:55         9.542538          1.121\n",
       "2020-03-20 17:57:23         6.643000          2.295\n",
       "2020-03-20 18:00:17        19.854643          6.743\n",
       "2020-03-20 18:00:31         8.294000          0.838\n",
       "2020-03-20 18:03:51         7.061520         -0.332\n",
       "2020-03-20 18:04:27         7.475000          7.508\n",
       "2020-03-20 18:52:36         1.905500         -3.054\n",
       "2020-03-20 18:53:03        29.100600         11.461\n",
       "2020-03-20 18:53:06        -6.500000         -2.535\n",
       "2020-03-20 18:53:33         6.838000          2.372\n",
       "2020-03-20 18:55:36        14.883795          4.530\n",
       "2020-03-20 18:55:54         9.867000          9.510\n",
       "2020-03-20 18:57:03         3.055329         -4.711\n",
       "2020-03-20 18:57:05         7.026500          6.702\n",
       "2020-03-20 18:58:27        12.565803         -1.162\n",
       "2020-03-20 18:58:40        10.744500          4.096\n",
       "2020-03-20 18:59:40         7.141764         -1.393\n",
       "2020-03-20 18:59:52         2.762500          1.430\n",
       "2020-03-20 19:02:03         9.023724          0.432\n",
       "2020-03-20 19:03:13         6.916000          1.164\n",
       "2020-03-20 19:30:30         1.514978         -6.668\n",
       "2020-03-20 19:31:02        30.509000         16.359\n",
       "2020-03-20 19:31:05       -22.288500        -17.400\n",
       "2020-03-20 19:32:06        15.925000          6.734\n",
       "2020-03-20 19:32:09         7.813940          0.982\n",
       "2020-03-20 19:32:15        36.016120         16.670\n",
       "2020-03-20 19:32:17        -3.055000          7.768\n",
       "2020-03-20 19:32:26         9.009000          5.597\n",
       "2020-03-20 19:33:36        19.555931          6.903\n",
       "2020-03-20 19:33:44         6.831500          9.269\n",
       "2020-03-20 19:37:04         8.218524         -2.845\n",
       "2020-03-20 19:37:06         8.580000          6.611\n",
       "2020-03-20 19:37:14         0.576660         -6.050\n",
       "2020-03-20 19:40:02        12.701000          5.418\n",
       "2020-03-20 19:44:24         1.730473         -6.052\n",
       "2020-03-20 19:44:36         8.307000          9.711\n",
       "2020-03-20 20:14:50        -4.129470        -17.083\n",
       "2020-03-20 20:14:57        12.850500          8.379\n",
       "2020-03-20 20:15:13         9.168148         -5.961\n",
       "2020-03-20 20:15:53        13.006500         10.374\n",
       "2020-03-20 20:17:00         6.124460         -5.597\n",
       "2020-03-20 20:17:12        12.616500         10.471\n",
       "2020-03-20 20:19:11         2.102007          0.067\n",
       "2020-03-20 20:20:48         8.677500          8.307\n",
       "2020-03-20 20:32:18         5.458247         -1.308\n",
       "2020-03-20 20:33:15        11.004500          6.831\n",
       "2020-03-20 20:33:34         2.611830         -3.457\n",
       "2020-03-20 20:34:33        10.523500          6.891\n",
       "2020-03-20 20:35:12         7.818714          0.058\n",
       "2020-03-20 20:37:00        10.432500          4.017\n",
       "2020-03-20 20:49:04        14.436904         -0.246\n",
       "2020-03-20 20:49:06         7.956000          3.888\n",
       "2020-03-20 21:07:20         7.219656         -0.067\n",
       "2020-03-20 21:07:28         7.202000          4.557\n",
       "2020-03-20 21:25:55        15.567241          3.521\n",
       "2020-03-20 21:26:17        10.237500          2.828\n",
       "2020-03-20 21:26:25         6.950260         -0.543\n",
       "2020-03-20 21:26:33         8.840000          3.562\n",
       "2020-03-20 21:28:53         6.200344         -3.757\n",
       "2020-03-20 21:29:18         8.430500          7.202\n",
       "2020-03-20 21:34:13         1.744593         -2.764\n",
       "2020-03-20 21:34:59         7.624500          0.448\n",
       "2020-03-20 21:40:27        11.625957         -1.679\n",
       "2020-03-20 21:40:34         8.521500          5.116\n",
       "2020-03-20 22:06:24         7.068373         -2.589\n",
       "2020-03-20 22:06:28         8.866000          5.397\n",
       "2020-03-20 22:28:45        -2.037714          2.974\n",
       "2020-03-20 22:28:46        10.133500          6.298\n",
       "2020-03-20 22:38:31        10.640479         -0.980\n",
       "2020-03-20 22:38:37         6.656000          8.534\n",
       "2020-03-20 22:48:41        -9.027979         -8.762\n",
       "2020-03-20 22:54:38         8.703500          7.013\n",
       "2020-03-20 22:58:51         3.609511         -2.352\n",
       "2020-03-20 22:59:08         7.052500          3.542\n",
       "2020-03-20 23:03:52        12.116932          5.689\n",
       "2020-03-20 23:03:57         6.636500          5.753\n",
       "2020-03-20 23:10:19         7.172701          4.319\n",
       "2020-03-20 23:10:31         7.033000          3.602\n",
       "2020-03-20 23:26:23         9.955791         -2.522\n",
       "2020-03-20 23:26:42         6.662500          2.255\n",
       "2020-03-20 23:28:12         8.965120          2.097\n",
       "2020-03-20 23:28:42         7.819500          2.568\n",
       "2020-03-20 23:33:15        10.901243          1.464\n",
       "2020-03-20 23:34:09         6.786000          3.725\n",
       "2020-03-20 23:39:10        11.512235          1.147\n",
       "2020-03-20 23:39:23         7.065500          0.676\n",
       "2020-03-20 23:39:28        10.256660          1.664\n",
       "2020-03-20 23:39:45         8.755500          3.036\n",
       "2020-03-20 23:40:17         8.184900         -1.085\n",
       "2020-03-20 23:41:46         7.436000          1.755\n",
       "2020-03-20 23:45:05         0.021309          2.088\n",
       "2020-03-20 23:45:49         6.929000          4.039\n",
       "2020-03-20 23:53:56        14.825200          2.862\n",
       "2020-03-20 23:54:04         7.540000          6.715\n",
       "2020-03-21 00:10:19         9.816099          1.673"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd.set_option('display.max_rows', None)\n",
    "profit_df"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## coincheck buyにおける売却コインの差分分析"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [],
   "source": [
    "cc_buy_trades = cc_trades[cc_trades[\"side\"] == \"buy\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(0.00644417, 0.00650905, 0.006487992820512821)"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "cc_buy_amount = cc_buy_trades[\"amount\"]\n",
    "min(cc_buy_amount), max(cc_buy_amount), np.mean(cc_buy_amount)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'0.0000120072'"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from decimal import Decimal\n",
    "num = 0.0065 - np.mean(cc_buy_amount)\n",
    "\"{0:.10f}\".format(Decimal(num))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Environment (conda_bakuchi)",
   "language": "python",
   "name": "conda_bakuchi"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
